using System.Collections.Generic;
using UnityEngine;
using MEC;

public class InvulnerabilityFrames : MonoBehaviour
{
    PlayerHealth _health;

    [Header ("Behavior Settings")]
    [SerializeField] int _numOfFlash;
    [SerializeField] float _duration;

    public void Start()
    {
        _health = GetComponent<PlayerHealth>();
    }

    public void Flash()
    {
        Timing.RunCoroutine(_FlashCoroutine());
    }

    // IFrame flashing
    IEnumerator<float> _FlashCoroutine()
    {
        int flashCounter = 0;
        _health.isInvulnerable = true;
        SpriteFlash spriteFlash = GetComponent<SpriteFlash>();

        while (flashCounter < _numOfFlash) {
            yield return Timing.WaitForSeconds (_duration / _numOfFlash);
            spriteFlash.PlayDamagedFlashEffect();
            flashCounter++;
        }

        _health.isInvulnerable = false;
    }

}